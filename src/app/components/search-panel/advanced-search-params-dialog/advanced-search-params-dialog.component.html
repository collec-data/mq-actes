<form #form="ngForm" (ngSubmit)="validate(form)">
  <h2 mat-dialog-title>Affiner votre recherche</h2>

  <mat-dialog-content>
    <div class="sub-section">
      <h3>Date de publication</h3>

      <mat-form-field appearance="fill">
        <mat-label>Début</mat-label>
        <input
          matInput
          [matDatepicker]="startPicker"
          name="date_debut"
          [(ngModel)]="updatedParams.date_debut"
          #debut="ngModel"
        >
        <button
          *ngIf="updatedParams.date_debut"
          matSuffix
          mat-icon-button
          aria-label="Effacer"
          matTooltip="Effacer"
          (click)="updatedParams.date_debut = undefined"
        >
          <mat-icon>close</mat-icon>
        </button>
        <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
        <mat-datepicker #startPicker></mat-datepicker>
        <mat-error *ngIf="debut.hasError('matStartDateInvalid')">Date invalide</mat-error>
      </mat-form-field>

      et

      <mat-form-field appearance="fill">
        <mat-label>Fin</mat-label>
        <input
          matInput
          [matDatepicker]="endPicker"
          [min]="updatedParams.date_debut"
          name="date_fin"
          [(ngModel)]="updatedParams.date_fin"
          #fin="ngModel"
        >
        <button
          *ngIf="updatedParams.date_fin"
          matSuffix
          mat-icon-button
          aria-label="Effacer"
          matTooltip="Effacer"
          (click)="updatedParams.date_fin = undefined"
        >
          <mat-icon>close</mat-icon>
        </button>
        <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
        <mat-datepicker #endPicker></mat-datepicker>
        <mat-error *ngIf="fin.hasError('matEndDateInvalid')">Date invalide</mat-error>
        <mat-error *ngIf="fin.hasError('matDatepickerMin')">La date de fin doit se trouver après le début</mat-error>
      </mat-form-field>
    </div>

    <div class="sub-section">
      <h3>Classification</h3>

      <div class="columns-sm">
        <div *ngFor="let check of classifications | keyvalue">
          <mat-checkbox
            class="checkbox-text-wrap"
            [checked]="updatedParams.classifications?.has($any(check.key))"
            (change)="toggleElement(updatedParams.classifications, check.key)"
          >
            {{check.value}}
          </mat-checkbox>
        </div>
      </div>
    </div>

    <div class="sub-section">
      <h3>Type d'acte</h3>

      <div class="columns-sm">
        <div *ngFor="let check of typesActe | keyvalue">
          <mat-checkbox
            class="checkbox-text-wrap"
            [checked]="updatedParams.types_actes?.has($any(check.key))"
            (change)="toggleElement(updatedParams.types_actes, check.key)"
          >
            {{check.value}}
          </mat-checkbox>
        </div>
      </div>
    </div>

  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button color="primary" type="submit">Appliquer les filtres</button>
  </mat-dialog-actions>
</form>
